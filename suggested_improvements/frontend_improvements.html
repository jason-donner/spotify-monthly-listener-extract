<!-- Modern frontend suggestions -->

<!-- 1. Add Vue.js or React for better interactivity -->
<!-- Option A: Vue.js (lightweight, good for gradual adoption) -->
<script src="https://cdn.jsdelivr.net/npm/vue@3/dist/vue.global.js"></script>

<!-- Interactive search component example -->
<div id="artist-search-app">
  <div class="search-container">
    <input 
      v-model="searchQuery" 
      @input="debounceSearch"
      placeholder="Search artists..." 
      class="form-control"
    >
    <div v-if="loading" class="spinner-border" role="status"></div>
    <div v-if="results.length > 0" class="search-results">
      <div 
        v-for="artist in results" 
        :key="artist.id"
        @click="selectArtist(artist)"
        class="search-result-item"
      >
        <img :src="artist.image || '/static/placeholder.png'" :alt="artist.name">
        <div>
          <h6>{{ artist.name }}</h6>
          <small>{{ formatNumber(artist.followers) }} followers</small>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
const { createApp } = Vue;

createApp({
  data() {
    return {
      searchQuery: '',
      results: [],
      loading: false,
      debounceTimer: null
    }
  },
  methods: {
    debounceSearch() {
      clearTimeout(this.debounceTimer);
      this.debounceTimer = setTimeout(() => {
        this.searchArtists();
      }, 300);
    },
    
    async searchArtists() {
      if (this.searchQuery.length < 2) {
        this.results = [];
        return;
      }
      
      this.loading = true;
      try {
        const response = await fetch(`/search_spotify_artists?q=${encodeURIComponent(this.searchQuery)}`);
        const data = await response.json();
        this.results = data.artists || [];
      } catch (error) {
        console.error('Search error:', error);
      } finally {
        this.loading = false;
      }
    },
    
    selectArtist(artist) {
      this.$emit('artistSelected', artist);
      this.searchQuery = artist.name;
      this.results = [];
    },
    
    formatNumber(num) {
      if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M';
      if (num >= 1000) return (num / 1000).toFixed(1) + 'K';
      return num.toString();
    }
  }
}).mount('#artist-search-app');
</script>

<!-- 2. Progressive Web App features -->
<!-- Add to base.html -->
<link rel="manifest" href="/static/manifest.json">
<meta name="theme-color" content="#1DB954">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="apple-mobile-web-app-title" content="Spotify Tracker">

<!-- 3. Better chart library (Chart.js with plugins) -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>

<script>
// Advanced chart configuration
function createListenerChart(data, elementId) {
  const ctx = document.getElementById(elementId).getContext('2d');
  
  return new Chart(ctx, {
    type: 'line',
    data: {
      datasets: [{
        label: 'Monthly Listeners',
        data: data.map(item => ({
          x: new Date(item.date),
          y: item.monthly_listeners
        })),
        borderColor: '#1DB954',
        backgroundColor: 'rgba(29, 185, 84, 0.1)',
        tension: 0.4,
        fill: true
      }]
    },
    options: {
      responsive: true,
      interaction: {
        intersect: false,
        mode: 'index'
      },
      scales: {
        x: {
          type: 'time',
          time: {
            displayFormats: {
              day: 'MMM dd',
              week: 'MMM dd',
              month: 'MMM yyyy'
            }
          }
        },
        y: {
          beginAtZero: false,
          ticks: {
            callback: function(value) {
              if (value >= 1000000) return (value / 1000000).toFixed(1) + 'M';
              if (value >= 1000) return (value / 1000).toFixed(1) + 'K';
              return value;
            }
          }
        }
      },
      plugins: {
        tooltip: {
          callbacks: {
            label: function(context) {
              return `Listeners: ${context.parsed.y.toLocaleString()}`;
            }
          }
        },
        legend: {
          display: false
        }
      }
    }
  });
}
</script>

<!-- 4. Dark/Light theme toggle -->
<div class="theme-toggle">
  <button id="theme-toggle-btn" class="btn btn-outline-secondary">
    <i class="fas fa-moon"></i>
  </button>
</div>

<script>
class ThemeManager {
  constructor() {
    this.theme = localStorage.getItem('theme') || 'dark';
    this.init();
  }
  
  init() {
    document.documentElement.setAttribute('data-theme', this.theme);
    this.updateToggleButton();
    
    document.getElementById('theme-toggle-btn').addEventListener('click', () => {
      this.toggle();
    });
  }
  
  toggle() {
    this.theme = this.theme === 'dark' ? 'light' : 'dark';
    document.documentElement.setAttribute('data-theme', this.theme);
    localStorage.setItem('theme', this.theme);
    this.updateToggleButton();
  }
  
  updateToggleButton() {
    const btn = document.getElementById('theme-toggle-btn');
    const icon = btn.querySelector('i');
    icon.className = this.theme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
  }
}

// Initialize theme manager
new ThemeManager();
</script>

<!-- 5. Better loading states and error handling -->
<div class="loading-overlay" id="loadingOverlay" style="display: none;">
  <div class="spinner-container">
    <div class="spinner-border text-success" role="status">
      <span class="visually-hidden">Loading...</span>
    </div>
    <p class="mt-2">Loading data...</p>
  </div>
</div>

<style>
.loading-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.8);
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  z-index: 9999;
}

.spinner-container {
  text-align: center;
  color: white;
}
</style>
